library(spdep)
library(adespatial)
library(vegan)
KY_Soil_Data.csv <- read.csv("KY_Soil_Data.csv", header=T)
Wise_DH_Lensing_JR_2019.csv <- read.csv("Wise_DH_Lensing_JR_2019.csv", header=T)
KY_Soil_Data.mat <- as.matrix(KY_Soil_Data.csv)
Wise_DH_Lensing_JR_2019.mat <- as.matrix(Wise_DH_Lensing_JR_2019.csv)
KY_Soil_Data.mat
Wise_DH_Lensing_JR_2019.mat
library
library
library(spdep)
library(adespatial)
library(vegan)
KY_Soil_Data.csv <- read.csv("KY_Soil_Data.csv", header=T)
Wise_DH_Lensing_JR_2019.csv <- read.csv("Wise_DH_Lensing_JR_2019.csv", header=T)
KY_Soil_Data.mat <- as.matrix(KY_Soil_Data.csv)
Wise_DH_Lensing_JR_2019.mat <- as.matrix(Wise_DH_Lensing_JR_2019.csv)
#Soil Temp Controlling Arthropods
soiltemp.rda <- rda(df[,9:89]~avgmaxtemp + avgmintemp, data=df)
soiltemp.rda
setwd("C:/GitHub/morgan/Final Project")
install.packages("readxl")
library(readxl)
soiltemp.tibble <- read_excel("KY Soil Data.xlsx")
soiltemp <- as.data.frame(soiltemp.tibble)
head(soiltemp)
arthrain.tibble <- read_excel("Wise_DH_Lensing_JR_2019.xlsx")
arthrain <- as.data.frame(arthrain.tibble)
head(arthrain)
df <- merge(soiltemp, arthrain, by = "period")
df
library(spdep)
library(adespatial)
library(vegan)
KY_Soil_Data.csv <- read.csv("KY_Soil_Data.csv", header=T)
Wise_DH_Lensing_JR_2019.csv <- read.csv("Wise_DH_Lensing_JR_2019.csv", header=T)
KY_Soil_Data.mat <- as.matrix(KY_Soil_Data.csv)
Wise_DH_Lensing_JR_2019.mat <- as.matrix(Wise_DH_Lensing_JR_2019.csv)
#Soil Temp Controlling Arthropods
soiltemp.rda <- rda(df[,9:89]~avgmaxtemp + avgmintemp, data=df)
soiltemp.rda
RsquareAdj(soiltemp.rda)
#Rainfall Controlling Arthropods
rainfall.rda <- rda(df[,9:89]~trt, data=df)
rainfall.rda
RsquareAdj(rainfall.rda)
anova(soiltemp.rda, perm.max = 10000)
anova(rainfall.rda, perm.max = 10000)
plot(soiltemp.rda)
plot(rainfall.rda)
plot(soiltemp.rda, rainfall.rda)
summary(rainfall.rda)
summary(soiltemp.rda)
?ordiplot
plot(soiltemp.rda, xlim = c(-100,100), ylim = c(-100,350))
plot(soiltemp.rda, xlim = c(-100,100), ylim = c(-50,350))
plot(rainfall.rda, xlim = c(-100,100), ylim = c(-50,100))
plot(rainfall.rda, xlim = c(-75,100), ylim = c(-50,100))
plot(soiltemp.rda)
plot(soiltemp.rda, xlim = c(-150,150), ylim = c(-50,350))
plot(rainfall.rda)
plot(rainfall.rda, xlim = c(-75,100), ylim = c(-50,400))
plot(rainfall.rda, xlim = c(-75,100), ylim = c(-50,400))
plot(soiltemp.rda, xlim = c(-100,100), ylim = c(-50,350))
plot(rainfall.rda, xlim = c(-75,100), ylim = c(-50,400))
plot(soiltemp.rda, xlim = c(-100,100), ylim = c(-50,350))
plot(rainfall.rda, xlim = c(-75,100), ylim = c(-50,400))
plot1(soiltemp.rda, xlim = c(-100,100), ylim = c(-50,350))
plot(soiltemp.rda, xlim = c(-100,100), ylim = c(-50,350))
plot(rainfall.rda, xlim = c(-75,100), ylim = c(-50,400))
plot(soiltemp.rda, xlim = c(-100,100), ylim = c(-50,350))
plot(soiltemp.rda)
plot(rainfall.rda, xlim = c(-75,100), ylim = c(-50,400))
#About 8.95% of the variance in arthropod abundance is explained by rainfall level.
#This leaves about 91.1% of unexplained variance in arthropod abundance.
plot.window(xlim = c(-100,100), ylim = c(-50,350), asp = 1)
plot(soiltemp.rda)
#About 8.95% of the variance in arthropod abundance is explained by rainfall level.
#This leaves about 91.1% of unexplained variance in arthropod abundance.
plot.window(xlim = c(-100,100), ylim = c(-50,350), asp = 1)
plot(soiltemp.rda)
plot.cca(soiltemp.rda, xlim = c(-100,100), ylim = c(-50,350))
library(vegan)
plot.cca(soiltemp.rda, xlim = c(-100,100), ylim = c(-50,350))
?plot.cca
setwd("C:/GitHub/morgan/Final Project")
library(readxl)
soiltemp.tibble <- read_excel("KY Soil Data.xlsx")
soiltemp <- as.data.frame(soiltemp.tibble)
head(soiltemp)
arthrain.tibble <- read_excel("Wise_DH_Lensing_JR_2019.xlsx")
arthrain <- as.data.frame(arthrain.tibble)
head(arthrain)
df <- merge(soiltemp, arthrain, by = "period")
df
library(spdep)
library(adespatial)
library(vegan)
KY_Soil_Data.csv <- read.csv("KY_Soil_Data.csv", header=T)
Wise_DH_Lensing_JR_2019.csv <- read.csv("Wise_DH_Lensing_JR_2019.csv", header=T)
KY_Soil_Data.mat <- as.matrix(KY_Soil_Data.csv)
Wise_DH_Lensing_JR_2019.mat <- as.matrix(Wise_DH_Lensing_JR_2019.csv)
#Soil Temperature Controlling Arthropods
soiltemp.rda <- rda(df[,9:89]~avgmaxtemp + avgmintemp, data=df)
soiltemp.rda
RsquareAdj(soiltemp.rda)
anova(soiltemp.rda, perm.max = 10000)
summary(soiltemp.rda)
#Rainfall Controlling Arthropods
rainfall.rda <- rda(df[,9:89]~trt, data=df)
rainfall.rda
RsquareAdj(rainfall.rda)
anova(rainfall.rda, perm.max = 10000)
summary(rainfall.rda)
plot(soiltemp.rda)
plot(soiltemp.rda, ylim = c(1,2),display = c("sites", "species"))
plot(rainfall.rda)
plot(rainfall.rda, ylim = c(1,2), display = c("sites", "species"))
# First things first, load the vegan library.
# Any time you are looking at community ecology, the package is probably going to be vegan.
library(vegan)
# We will use the "dune" dataset from vegan.
# the dune data are plant communities from dune meadows.
data(dune)
# There is also a data frame of environmental factors that match the dune plants that we will use this week:
data(dune.env)
# We are focusing on Redundancy Analysis (RDA).
# But all of these methods can be transferred to other multivariate techniques very easily.
# pca() and cca() can typically just replace the rda() in any of these functions and models.
# The generic use of rda is very straightforward. All you need is a numeric species-by-site matrix.
dune #to see what I mean by a species-by-site matrix
ord <- rda(dune)
plot(ord)
ord <- rda(soiltemp)
ord
# The real power of RDA is the ability to explain variance via a model.
# We'll use the dune.env data and take a quick look first to see type of data are included:
head(dune.env)
# Agriculture use typically impacts plant communities, so we will start there.
# This should look very familiar to the model syntax we have used so far.
mod1 <- rda(dune ~ Use, dune.env)
mod1
#The model call gives us constrained and unconstrained variance
# Constrained is the percent of the axes that is explained by "Use"
# Unconstrained is similar to the residuals of a linear model.
# We can also call the anova() function the same way that you would for a linear model:
anova(mod1)
# Moisture is another common driver of plant community composition
mod2 <- rda(dune ~ Moisture, dune.env)
mod2
anova(mod2)
# Just like other models, we can include additive or interactive effects as well:
# We can see what the cumulative effect of management and soil moisture is on the plant community:
mod3 <- rda(dune ~ Moisture + Management, dune.env)
mod3
anova(mod3)
#Let's plot to see what this looks like visually:
plot(mod3)
# Because of the amount of information, ordination plots are best done in layers, like adding regression lines.
# First create a blank plot where the axes are auto-fitted to the min and max values of "mod3"
plot(mod3, type="n", display = c("sites", "scores"))
# Next we will add a layer where the points are displayed with a label that represents their management
text(mod3, display="sites", labels = as.character(dune.env$Management))
# Because of the amount of information, ordination plots are best done in layers, like adding regression lines.
# First create a blank plot where the axes are auto-fitted to the min and max values of "mod3"
plot(mod3, type="n", display = c("sites", "scores"))
plot(soiltemp.rda, ylim = c(1,2), display = c("sites", "species"))
plot(rainfall.rda, ylim = c(1,2), display = c("sites", "species"))
plot(soiltemp.rda, type="n", display = c("sites", "species"))
plot(soiltemp.rda, type="n", ylim = c(1,2), display = c("sites", "species"))
View(df)
text(soiltemp.rda, display = "sites", labels = as.character(df$species))
?text
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.character(df$Kthom))
text(soiltemp.rda, display = "sites", labels = as.character(df$plot))
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.character(df$plot))
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.character(df$Kthom))
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.character(df$Ktitan))
plot(soiltemp.rda)
plot(soiltemp.rda, ylim = c(1,2), display = c("species"))
plot(soiltemp.rda)
plot(soiltemp.rda, ylim = c(1,2), display = c("sites", "species"))
plot(soiltemp.rda, ylim = c(1,2), display = c("species"))
plot(soiltemp.rda, ylim = c(1,2), display = c("sites", "species"))
plot(soiltemp.rda, ylim = c(1,2), display = c("sites"))
plot(soiltemp.rda)
plot(soiltemp.rda, ylim = c(1,2), display = c("sites", "species"))
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.character(df$avgmintemp, df$avgmaxtemp))
plot(soiltemp.rda, ylim = c(1,2), display = c("sites", "species"))
plot(rainfall.rda)
plot(rainfall.rda, ylim = c(1,2), display = c("sites", "species"))
plot(rainfall.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(rainfall.rda, display = "sites", labels = as.character(df$trt))
text(rainfall.rda, display = "species", labels = as.character(df$Kthom))
plot(soiltemp.rda)
plot(soiltemp.rda, ylim = c(1,2), display = c("sites", "species"))
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.character(df$avgmintemp, df$avgmaxtemp))
text(soiltemp.rda, display = "species", labels = as.character(df$Kthom))
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.character(df$avgmintemp, df$avgmaxtemp))
text(soiltemp.rda, display = "species", labels = as.character(df$Ktherid))
plot(rainfall.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(rainfall.rda, display = "sites", labels = as.character(df$trt))
text(rainfall.rda, display = "species", labels = as.character(df$Ktherid))
View(df)
text(rainfall.rda, display = "species", labels = as.character(df[,9:89]))
text(rainfall.rda, display = "species", labels = as.character(colnamesdf[,9:89]))
text(rainfall.rda, display = "species", labels = as.character(colnames(df[,9:89])))
plot(rainfall.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(rainfall.rda, display = "species", labels = as.character(colnames(df[,9:89])))
text(rainfall.rda, display = "sites", labels = as.character(df$trt))
?color
?colorlist
plot(rainfall.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(rainfall.rda, display = "sites", labels = as.character(df$trt), col = "blue3")
text(rainfall.rda, display = "species", labels = as.character(colnames(df[,9:89])), col = "magenta")
plot(rainfall.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(rainfall.rda, display = "sites", labels = as.character(df$trt), col = "blue3")
text(rainfall.rda, display = "species", labels = as.character(colnames(df[,9:89])), col = "darkmagenta")
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "species", labels = as.character(colnames(df[,9:89])))
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "species", labels = as.character(colnames(df[,9:89])), col = "darkmagenta")
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.character(df$avgmintemp, df$avgmaxtemp), col = "blue3", cex = 0.75)
text(soiltemp.rda, display = "species", labels = as.character(colnames(df[,9:89])), col = "darkmagenta", cex = 0.75)
plot(rainfall.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(rainfall.rda, display = "sites", labels = as.character(df$trt), col = "blue3", cex = 0.75)
text(rainfall.rda, display = "species", labels = as.character(colnames(df[,9:89])), col = "darkmagenta", cex = 0.75)
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.character(df$avgmintemp, df$avgmaxtemp), col = "blue3", cex = 0.60)
text(soiltemp.rda, display = "species", labels = as.character(colnames(df[,9:89])), col = "darkmagenta", cex = 0.60)
plot(rainfall.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(rainfall.rda, display = "sites", labels = as.character(df$trt), col = "blue3", cex = 0.60)
text(rainfall.rda, display = "species", labels = as.character(colnames(df[,9:89])), col = "darkmagenta", cex = 0.60)
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.character(df$avgmintemp, df$avgmaxtemp), col = "blue3", cex = 0.65)
text(soiltemp.rda, display = "species", labels = as.character(colnames(df[,9:89])), col = "darkmagenta", cex = 0.65)
plot(rainfall.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(rainfall.rda, display = "sites", labels = as.character(df$trt), col = "blue3", cex = 0.65)
text(rainfall.rda, display = "species", labels = as.character(colnames(df[,9:89])), col = "darkmagenta", cex = 0.65)
text(soiltemp.rda, display = "sites", labels = as.numeric(df$avgmintemp, df$avgmaxtemp), col = "blue3", cex = 0.65)
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.numeric(df$avgmintemp, df$avgmaxtemp), col = "blue3", cex = 0.65)
text(soiltemp.rda, display = "species", labels = as.character(colnames(df[,9:89])), col = "darkmagenta", cex = 0.65)
setwd("C:/GitHub/morgan/Final Project")
library(readxl)
soiltemp.tibble <- read_excel("KY Soil Data.xlsx")
soiltemp <- as.data.frame(soiltemp.tibble)
head(soiltemp)
arthrain.tibble <- read_excel("Wise_DH_Lensing_JR_2019.xlsx")
arthrain <- as.data.frame(arthrain.tibble)
head(arthrain)
df <- merge(soiltemp, arthrain, by = "period")
df
df1 <- format(round(df$avgmaxtemp, 0), nsmall = 0)
df2 <- format(round(df1$avgmintemp, 0), nsmall = 0)
df2 <- format(round(df$avgmintemp, 0), nsmall = 0)
df2
df <- merge(soiltemp, arthrain, by = "period")
df
df1 <- format(round(df$avgmaxtemp, 0), nsmall = 0)
df1 <- format(round(df$avgmintemp, 0), nsmall = 0)
df1
df1 <- format((round(df$avgmaxtemp, 0), nsmall = 0)), (round(df$avgmintemp, 0), nsmall = 0))
df <- merge(soiltemp, arthrain, by = "period")
df1 <- format(round(df$avgmaxtemp, 0), nsmall = 0)
df1 <- format(round(df$avgmintemp, 0), nsmall = 0)
df1
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.numeric(df2$avgmintemp, df1$avgmaxtemp), col = "blue3", cex = 0.65)
text(soiltemp.rda, display = "sites", labels = as.numeric(df1$avgmintemp, df1$avgmaxtemp), col = "blue3", cex = 0.65)
df <- merge(soiltemp, arthrain, by = "period")
df
df1 <- format(round(df$avgmaxtemp, 0), nsmall = 0)
df1 <- format(round(df$avgmintemp, 0), nsmall = 0)
df1
library(spdep)
library(adespatial)
library(vegan)
KY_Soil_Data.csv <- read.csv("KY_Soil_Data.csv", header=T)
Wise_DH_Lensing_JR_2019.csv <- read.csv("Wise_DH_Lensing_JR_2019.csv", header=T)
KY_Soil_Data.mat <- as.matrix(KY_Soil_Data.csv)
Wise_DH_Lensing_JR_2019.mat <- as.matrix(Wise_DH_Lensing_JR_2019.csv)
#Soil Temperature Controlling Arthropods
soiltemp.rda <- rda(df1[,9:89]~avgmaxtemp + avgmintemp, data=df1)
soiltemp.rda
RsquareAdj(soiltemp.rda)
anova(soiltemp.rda, perm.max = 10000)
summary(soiltemp.rda)
#Rainfall Controlling Arthropods
rainfall.rda <- rda(df1[,9:89]~trt, data=df1)
rainfall.rda
RsquareAdj(rainfall.rda)
anova(rainfall.rda, perm.max = 10000)
summary(rainfall.rda)
plot(soiltemp.rda)
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.numeric(df1$avgmintemp, df1$avgmaxtemp), col = "blue3", cex = 0.65)
df1
df <- merge(soiltemp, arthrain, by = "period")
df
df$roundmaxtemp <- format(round(df$avgmaxtemp, 0), nsmall = 0)
df$roundmintemp <- format(round(df$avgmintemp, 0), nsmall = 0)
df
View(df)
df
KY_Soil_Data.csv <- read.csv("KY_Soil_Data.csv", header=T)
Wise_DH_Lensing_JR_2019.csv <- read.csv("Wise_DH_Lensing_JR_2019.csv", header=T)
KY_Soil_Data.mat <- as.matrix(KY_Soil_Data.csv)
Wise_DH_Lensing_JR_2019.mat <- as.matrix(Wise_DH_Lensing_JR_2019.csv)
#Soil Temperature Controlling Arthropods
soiltemp.rda <- rda(df[,9:89]~avgmaxtemp + avgmintemp, data=df)
soiltemp.rda
RsquareAdj(soiltemp.rda)
anova(soiltemp.rda, perm.max = 10000)
#Rainfall Controlling Arthropods
rainfall.rda <- rda(df[,9:89]~trt, data=df)
rainfall.rda
RsquareAdj(rainfall.rda)
anova(rainfall.rda, perm.max = 10000)
summary(rainfall.rda)
plot(soiltemp.rda)
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.numeric(df$avgmintemp, df$avgmaxtemp), col = "blue3", cex = 0.65)
text(soiltemp.rda, display = "species", labels = as.character(colnames(df[,9:89])), col = "darkmagenta", cex = 0.65)
plot(rainfall.rda)
plot(rainfall.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(rainfall.rda, display = "sites", labels = as.character(df$trt), col = "blue3", cex = 0.65)
text(rainfall.rda, display = "species", labels = as.character(colnames(df[,9:89])), col = "darkmagenta", cex = 0.65)
df <- merge(soiltemp, arthrain, by = "period")
df
df$roundmaxtemp <- format(round(df$avgmaxtemp, 0), nsmall = 0)
df$roundmintemp <- format(round(df$avgmintemp, 0), nsmall = 0)
df$roundmaxtemp <- format(round(df$avgmaxtemp, 0), nsmall = 0)
df$roundmintemp <- format(round(df$avgmintemp, 0), nsmall = 0)
plot(soiltemp.rda)
plot(soiltemp.rda, type = "n", ylim = c(1,2), display = c("sites", "species"))
text(soiltemp.rda, display = "sites", labels = as.numeric(df$roundmintemp, df$roundmaxtemp), col = "blue3", cex = 0.65)
text(soiltemp.rda, display = "species", labels = as.character(colnames(df[,9:89])), col = "darkmagenta", cex = 0.65)
