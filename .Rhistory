install.packages("learnPopGen")
genetic.drift()
object<-genetic.drift(p0=0.7,show="heterozygosity")
plot(object,show="genotypes")
genetic.drift(p0=0.5, Ne=20, nrep=10, time=100, show="p", pause=0.1, ...)
genetic.drift(p0=0.5, Ne=20, nrep=10, time=100, show="p", pause=0.1, ...)
object<-genetic.drift(p0=0.5, Ne=20, nrep=10, time=100, show="p", pause=0.1, ...)
plot(object,show="genotypes")
genetic.drift(p0=0.5, Ne=20, nrep=10, time=100, show="p", pause=0.1)
object<-genetic.drift(p0=0.5, Ne=20, nrep=10, time=100, show="p", pause=0.1)
library(learnPopGen)
install.packages("learnPopGen")
genetic.drift(p0=0.5, Ne=20, nrep=10, time=100, show="p", pause=0.1)
object<-genetic.drift(p0=0.5, Ne=20, nrep=10, time=100, show="p", pause=0.1)
plot(object,show="p")
library(learnPopGen)
genetic.drift(p0=0.5, Ne=20, nrep=10, time=100, show="p", pause=0.1)
object<-genetic.drift(p0=0.5, Ne=20, nrep=10, time=100, show="p", pause=0.1)
plot(object,show="p")
genetic.drift(p0=0.7, Ne=50, nrep=25, time=150, show="genotypes", pause=0.1)
object<-genetic.drift(p0=0.7, Ne=50, nrep=25, time=150, show="genotypes", pause=0.1)
plot(object,show="genotypes")
library(vegan)
install.packages("vegan")
library(vegan)
install.packages("vegan")
install.packages("vegan")
library(vegan)
install.packages("diversity")
install.packages("diveRsity")
library(diveRsity)
install.packages("vegan")
install.packages("vegan")
install.packages("vegan")
library(vegan)
install.package("permute")
install.packages("permute")
install.packages("permute")
install.packages("lattice")
library(permute)
library(lattice)
x <- c(15, 6, 4, 0, 3, 0)
dominance(x)
library(vegan)
library(permute)
library(lattice)
x <- c(15, 6, 4, 0, 3, 0)
dominance(x)
simpson.unb(x)
simpson.unb(x, inverse=FALSE)
x <- c(15, 6, 4, 0, 3, 0)
simpson.unb(x, inverse=FALSE)
simpson.unb
x <- c(12, 4, 3, 1, 2, 1)
invsimpson(x)
?invsimpson(x)
x <- c(15, 6, 4, 0, 3, 0)
diversity(x, index = "Shannon", groups, equalize.groups = FALSE, MARGIN = 1, base = exp(1))
simpson.unb(x, inverse + FALSE)
fisher.aplha(x, MARGIN = 1)
specnumber(x, groups, MARGIN = 1)
library(vegan)
x <- c(15, 6, 4, 0, 3, 0)
diversity(x, index = "Shannon", groups, equalize.groups = FALSE, MARGIN = 1, base = exp(1))
simpson.unb(x, inverse + FALSE)
fisher.aplha(x, MARGIN = 1)
specnumber(x, groups, MARGIN = 1)
x <- c(15, 6, 4, 0, 3, 0)
diversity(x, index = "Shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1))
simpson(x, inverse + FALSE)
simpson(x, inverse = FALSE)
simpson.unb(x, inverse = FALSE)
fisher.aplha(x, MARGIN = 1)
install.packages(diveRsity)
install.packages("diveRsity")
library(diveRsity)
library(diveRsity)
data(BCI, BCI.env)
H <- diversity(BCI)
simp <- diversity(BCI, "simpson")
invsimp <- diversity(BCI, "inv")
x <- c(15, 6, 4, 0, 3, 0)
diversity(x, index = "Shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1))
simpson.unb(x, inverse = FALSE)
x <- c(12, 4, 3, 1, 2, 1)
inv(x)
help(diversity)
x <- c(15, 6, 4, 0, 3, 0)
diversity(x, index = "Shannon", groups = 6, equalize.groups = FALSE, MARGIN = 1, base = exp(1))
diversity(x, index = "simpson", groups = 6, equalize.groups = FALSE, MARGIN = 1, base = exp(1))
simpson.unb(x, inverse = FALSE)
data(BCI, BCI.env)
H <- diversity(BCI)
simp <- diversity(BCI, "simpson")
invsimp <- diversity(BCI, "inv")
library(diveRsity)
x <- c(15, 6, 4, 0, 3, 0)
diversity(x, index = "simpson", groups = 6, equalize.groups = FALSE, MARGIN = 1, base = exp(1))
simpson.unb(x, inverse = FALSE)
x <- c(12, 4, 3, 1, 2, 1)
diversity(x, index = "invsimpson", groups = 6, equalize.groups = FALSE, MARGIN = 1, base = exp(1))
invsimpson(x, "invsimpson")
invsimpson(x, inverse = TRUE)
x <- c(12, 4, 3, 1, 2, 1)
diversity(x, index = "invsimpson", groups = 6, equalize.groups = FALSE, MARGIN = 1, base = exp(1))
invsimpson(x, inverse = TRUE)
invsimpson(x, "invsimpson")
x <- c(12, 4, 3, 1, 2, 1)
diversity(x, index = "invsimpson", groups = 6, equalize.groups = FALSE, MARGIN = 1, base = exp(1))
invsimp(x, "invsimp")
invsimp(x, "inversesimpson")
invsimp(x, inverse = TRUE)
library(vegan)
library(permute)
library(lattice)
library(diveRsity)
x <- c(15, 6, 4, 0, 3, 0)
diversity(x, index = "simpson", groups = 6, equalize.groups = FALSE, MARGIN = 1, base = exp(1))
x <- c(12, 4, 3, 1, 2, 1)
diversity(x, index = "invsimpson", groups = 6, equalize.groups = FALSE, MARGIN = 1, base = exp(1))
x <- c(12, 4, 3, 1, 2, 1)
diversity(x, index = "invsimpson", groups = 6, equalize.groups = FALSE, MARGIN = 1, base = exp(1))
setwd("C:/GitHub/morgan")
jpeg(file = "Thomas Genetic Drift Reference Manual Example.jpeg", width = 4, height = 3)
jpeg(file = "Thomas Genetic Drift Reference Manual Example.jpeg", width = 3, height = 2)
jpeg(file = "Thomas Genetic Drift Reference Manual Example.jpeg")
par(family = "serif")
dev.off()
jpeg(file = "Thomas Genetic Drift Manipulated Example.jpeg")
par(family = "serif")
dev.off()
library(learnPopGen)
genetic.drift(p0=0.7, Ne=50, nrep=25, time=150, show="genotypes", pause=0.1)
object<-genetic.drift(p0=0.7, Ne=50, nrep=25, time=150, show="genotypes", pause=0.1)
plot(object,show="genotypes")
jpeg(file = "Thomas Genetic Drift Manipulated Example.jpeg")
par(family = "serif")
dev.off()
library(learnPopGen)
genetic.drift(p0=0.5, Ne=20, nrep=10, time=100, show="p", pause=0.1)
object<-genetic.drift(p0=0.5, Ne=20, nrep=10, time=100, show="p", pause=0.1)
plot(object,show="p")
setwd("C:/GitHub/morgan")
jpeg(file = "Thomas Genetic Drift Ref Manual Example.jpeg")
par(family = "serif")
dev.off()
data <- read.csv(file=("C:/GitHub/morgan/Week 5/Figure4Data.csv"), header=T)
#(1) Poisson
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fitp <- fitdist(c(na.exclude(one.col)), distr = "pois")
fitp
library(fitdistrplus)
library(logspline)
#(1) Poisson
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fitp <- fitdist(c(na.exclude(one.col)), distr = "pois")
fitp
#(1) Negative Binomial
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fitnb <- fitdist(c(na.exclude(one.col)), distr = "nbinom")
fitnb
#(1) Logistic
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fit.logis <- fitdist(c(na.exclude(one.col)), distr = "logis")
fit.logis
gofstat(list(fitp, fitnb, fit.logis))
fits = lapply(fitnames, function(i){fitdist(prob, distr = i, method = "mle")})
fits = lapply(fitp, fitnb, fit.logis, function(i){fitdist(prob, distr = i, method = "mle")})
data <- read.csv(file=("C:/GitHub/morgan/Week 5/Figure4Data.csv"), header=T)
library(fitdistrplus)
library(logspline)
#(1) Poisson
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fitp <- fitdist(c(na.exclude(one.col)), distr = "pois")
fitp
#(1) Negative Binomial
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fitnb <- fitdist(c(na.exclude(one.col)), distr = "nbinom")
fitnb
#(1) Logistic
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fit.logis <- fitdist(c(na.exclude(one.col)), distr = "logis")
fit.logis
gofstat(list(fitp, fitnb, fit.logis))
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fitp <- fitdist(c(na.exclude(one.col)), distr = "pois")
fitp
#(1) Negative Binomial
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fitnb <- fitdist(c(na.exclude(one.col)), distr = "nbinom")
fitnb
#(1) Logistic
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fit.logis <- fitdist(c(na.exclude(one.col)), distr = "logis")
fit.logis
fits <- lapply(fitp, fitnb, fit.logis, function(i){fitdist(prob, distr = i, method = "mle")})
gofstat(list(fitp, fitnb, fit.logis), chisqbreaks=c(1,2,4,8,16,32,64))
gofstat(list(fitp, fitnb, fit.logis), chisqbreaks=c(1,2,4,8,16,32,64))
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fitp <- fitdist(c(na.exclude(one.col)), distr = "pois")
fitp
#(1) Negative Binomial
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fitnb <- fitdist(c(na.exclude(one.col)), distr = "nbinom")
fitnb
#(1) Logistic
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fit.logis <- fitdist(c(na.exclude(one.col)), distr = "logis")
fit.logis
gofstat(list(fitp, fitnb, fit.logis), chisqbreaks=c(1,2,4,8,16,32,64))
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fitp <- fitdist(c(na.exclude(one.col)), distr = "pois")
fitp
#(1) Negative Binomial
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fitnb <- fitdist(c(na.exclude(one.col)), distr = "nbinom")
fitnb
#(1) Logistic
one.col <- data$Num.Cells.Progeny
hist(one.col, main = "Number of Cells in Progeny")
fit.logis <- fitdist(c(na.exclude(one.col)), distr = "logis")
fit.logis
gofstat(list(fitp, fitnb, fit.logis), chisqbreaks=c(1,2,4,8,16,32,64))
one.col <- data$RepTime.sec
hist(one.col, main = "Replication Time")
fitp <- fitdist(c(na.exclude(one.col)), distr = "pois")
fitp
#(2) Negative Binomial
one.col <- data$RepTime.sec
hist(one.col, main = "Replication Time")
fitnb <- fitdist(c(na.exclude(one.col)), distr = "nbinom")
fitnb
#(2) Logistic
one.col <- data$RepTime.sec
hist(one.col, main = "Replication Time")
fit.logis <- fitdist(c(na.exclude(one.col)), distr = "logis")
fit.logis
gofstat(list(fitp, fitnb, fit.logis), chisqbreaks=c(1,2,4,8,16,32,64))
one.col <- data$RepTime.sec
hist(one.col, main = "Time")
fit.norm <- fitdist(one.col*100, distr = "norm")
hist(one.col, main = "Replication Time")
fit.norm <- fitdist(one.col*100, distr = "norm")
plot(fit.norm)
one.col <- data$RepTime.sec
hist(one.col, main = "Replication Time")
fit.norm <- fitdist(c(na.exclude(one.col)), distr = "norm")
plot(fit.norm)
one.col <- data$RepTime.sec
hist(one.col, main = "Replication Time")
one.col?
one.col?
?one.col
library(MASS)
library (MuMIn)
library(mgcv)
install.packages(MuMIn)
library (MuMIn)
install.packages(MuMIn)
install.packages("MuMIn")
library (MuMIn)
library(mgcv)
setwd("C:/GitHub/morgan/Week6")
df <- read.csv("Toscano_Griffen_Data.csv")
df
data <- read.csv(file=("C:/GitHub/morgan/Week 6/Toscano_Griffen_Data.csv"), header=T)
df
df <- read.csv(file=("C:/GitHub/morgan/Week 6/Toscano_Griffen_Data.csv"), header=T)
df
#Additive Effects
gam.mod1 <- gam(activity.level~claw.width + carapace.width + toadfish.cue.treatment, family = binomial, random = list(ID=~ 1), data = df)
summary(gam.mod1)
r.squaredGAM(gam.mod1)
r.squared(gam.mod1)
#Additive Effects
glmm.mod1 <- glmmPQL(activity.level~claw.width + carapace.width + toadfish.cue.treatment, family = binomial, random = ~ 1 | ID, data = df)
df
#Additive Effects
glmm.mod1 <- glmmPQL(activity.level~claw.width + carapace.width + toadfish.cue.treatment, family = binomial, random = ~ 1 | ID, data = df)
# Re-run both models as generalized additive models instead (using gam). Then compare the AIC of both models. (4 points each)
#Additive Effects
gam.mod1 <- gam(activity.level~claw.width + carapace.width + toadfish.cue.treatment, family = binomial, random = list(ID=~ 1), data = df)
summary(gam.mod1)
# Re-run both models as generalized additive models instead (using gam). Then compare the AIC of both models. (4 points each)
#Additive Effects
gam.mod1 <- gam(activity.level~claw.width + carapace.width + toadfish.cue.treatment, family = binomial, random = list(ID=~ 1), data = df)
summary(gam.mod1)
#Interactive Effect
gam.mod2 <- gam(activity.level~claw.width * carapace.width * toadfish.cue.treatment, family = binomial, random = list(ID=~ 1), data = df)
summary(gam.mod2)
#Interactive Effect
gam.mod2 <- gam(activity.level~claw.width * carapace.width * toadfish.cue.treatment, family = binomial, random = list(ID=~ 1), data = df)
summary(gam.mod2)
AIC(gam.mod1, gam.mod2)
# (Q5) - Based on the residuals of your generalized additive models, how confident are you in these results? (2 pts)
plot(gam.mod1$residuals, ylim = c(-.1,.1))
# (Q5) - Based on the residuals of your generalized additive models, how confident are you in these results? (2 pts)
plot(gam.mod1$residuals, ylim = c(-.1,.1))
plot(gam.mod2$residuals, ylim = c(-.1,.1))
# (Q5) - Based on the residuals of your generalized additive models, how confident are you in these results? (2 pts)
plot(gam.mod1$residuals, ylim = c(-.1,.1))
plot(gam.mod2$residuals, ylim = c(-.1,.1))
df
#Additive Effects
glmm.mod1 <- glmmPQL(activity.level~claw.width + carapace.width + toadfish.cue.treatment, family = binomial, random = ~ 1 | ID, data = df)
summary(glmm.mod1)
#Interactive Effect
glmm.mod2 <- glmmPQL(activity.level~claw.width + carapace.width * toadfish.cue.treatment, family = binomial, random = ~ 1 | ID, data = df)
summary(glmm.mod2)
df <- read.csv("Uchidaetal_2019_Data.csv")
setwd("C:/GitHub/R4Eco_2022/Week6")
df <- read.csv("Uchidaetal_2019_Data.csv")
# Take a look and see what our data look like this week:
head(df)
# To start, we are going to use a assume a normal (aka Gaussian) distribution because we are using a linear model:
# The argument "random = ~ 1 | ID" is used to specify individual as a random effect.
# The "~ 1 |" notation is common across model functions to signify a random effect.
# The 'family' argument is used to specify the distribution family.
# Options for this can be found by looking up ?family.
# Otherwise this function should look very similar to the arguments in the lm() function for fixed effects.
glmm.mod <- glmmPQL(Flight.initiation.distance..FID.~Object, family = gaussian, random = ~ 1 | ID, data = df)
df
head(df)
#Additive Effects
glmm.mod1 <- glmmPQL(activity.level~claw.width + carapace.width + toadfish.cue.treatment, family = binomial, random = ~ 1 | ID, data = df)
summary(glmm.mod1)
#Additive Effects
glmm.mod1 <- glmmPQL(activity.level~claw.width + carapace.width + toadfish.cue.treatment, family = binomial, random = ~ 1 | ID, data = df)
# The authors used proportional consumption of prey as the (y) in their model, but did not include this in the dataset.
# So we are going to create it - run the following line, assuming df= your data frame (feel free to change that):
df$prop.cons <- df$eaten/df$prey
df <- read.csv(file=("C:/GitHub/morgan/Week 6/Toscano_Griffen_Data.csv"), header=T)
df
head(df)
#Additive Effects
glmm.mod1 <- glmmPQL(activity.level~claw.width + carapace.width + toadfish.cue.treatment, family = binomial, random = ~ 1 | block, data = df)
library(MASS)
library (MuMIn)
library(mgcv)
#Additive Effects
glmm.mod1 <- glmmPQL(activity.level~claw.width + carapace.width + toadfish.cue.treatment, family = binomial, random = ~ 1 | block, data = df)
summary(glmm.mod1)
r.squaredGLMM(glmm.mod1)
r.squaredGLMM(glmm.mod1)
#Interactive Effect
glmm.mod2 <- glmmPQL(activity.level~claw.width + carapace.width * toadfish.cue.treatment, family = binomial, random = ~ 1 | block, data = df)
summary(glmm.mod2)
# The authors used proportional consumption of prey as the (y) in their model, but did not include this in the dataset.
# So we are going to create it - run the following line, assuming df= your data frame (feel free to change that):
df$prop.cons <- df$eaten/df$prey
# (Q3) - Plot the residuals of both models. Do you think either model is a good fit? Why or why not? (3 pts)
plot(glmm.mod1$residuals, ylim = c(-.1,.1))
plot(glmm.mod2$residuals, ylim = c(-.1,.1))
#Additive Effects
glmm.mod1 <- glmmPQL(activity.level~claw.width + carapace.width + toadfish.cue.treatment, family = binomial, random = ~ 1 | block, data = df)
summary(glmm.mod1)
#Interactive Effect
glmm.mod2 <- glmmPQL(activity.level~claw.width + carapace.width * toadfish.cue.treatment, family = binomial, random = ~ 1 | block, data = df)
summary(glmm.mod2)
df
#Additive Effects
glmm.mod1 <- glmmPQL(activity.level~claw.width + carapace.width + toadfish.cue.treatment, family = binomial, random = ~ 1 | block, data = df)
summary(glmm.mod1)
#Interactive Effect
glmm.mod2 <- glmmPQL(activity.level~claw.width * carapace.width + toadfish.cue.treatment, family = binomial, random = ~ 1 | block, data = df)
summary(glmm.mod2)
